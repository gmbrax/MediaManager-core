####################################################################################################################
# WARNING: Do not store sensitive information in this file, as its contents will be included in the Qodana report. #
####################################################################################################################

version: "1.0"
# Use canonical linter name to avoid image warnings and CLI flag issues
linter: qodana-jvm
profile:
  name: qodana.recommended
bootstrap: |
  # Generate sources (including protobuf) so Qodana resolves imports correctly
  # Prefer Maven Wrapper if present; fall back to system mvn (POSIX sh compatible)
  # Ensure mvnw is executable if present
  if [ -f ./mvnw ]; then chmod +x ./mvnw || true; fi
  if [ -x ./mvnw ]; then
    ./mvnw -B -q -DskipTests -DskipITs=true generate-sources || true
  elif [ -f ./mvnw ]; then
    sh ./mvnw -B -q -DskipTests -DskipITs=true generate-sources || true
  elif command -v mvn >/dev/null 2>&1; then
    mvn -B -q -DskipTests -DskipITs=true generate-sources || true
  else
    echo "[Qodana bootstrap] Maven not available; skipping source generation"
  fi
include:
  - name: CheckDependencyLicenses
exclude:
  # Exclude generated sources from inspections to reduce noise
  - name: All
    paths:
      - target/generated-sources/**
      - target/protoc-dependencies/**